<style>
  #shopify-section-{{ section.id }},
  .shopify-section:has(#faq-section-{{ section.id }}) {
    overflow: visible !important;
    position: relative;
  }
  #faq-section-{{ section.id }}.faq-section-wrapper,
  .faq-sec#faq-section-{{ section.id }},
  section.faq-sec.faq-section-wrapper,
  .faq-sec {
    position: relative;
    overflow: visible !important;
  }
  
  /* Top wave positioning */
  .faq-section__wave--top {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    z-index: 5;
    line-height: 0;
    transform: translateY(-100%);
  }
  .faq-section__wave--top.inverted {
    transform: translateY(-100%) scaleY(-1);
    transform-origin: center bottom;
  }
  .faq-section__wave--top svg {
    width: 100%;
    height: 100%;
    display: block;
  }
  
  /* Bottom wave positioning */
  .faq-section__wave--bottom {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    z-index: 5;
    line-height: 0;
    transform: translateY(100%);
  }
  .faq-section__wave--bottom.inverted {
    transform: translateY(100%) scaleY(-1);
    transform-origin: center top;
  }
  .faq-section__wave--bottom svg {
    width: 100%;
    height: 100%;
    display: block;
  }
</style>
<section id="faq-section-{{ section.id }}" class="faq-section-wrapper" style="position: relative; overflow: visible;">
  <!-- Top Wave Divider -->
  {%- if section.settings.show_top_wave -%}
    <div class="faq-section__wave faq-section__wave--top{% if section.settings.invert_top_wave %} inverted{% endif %}" style="height: {{ section.settings.wave_height }}px;">
      <svg viewBox="0 0 1440 120" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg">
        {%- case section.settings.top_wave_style -%}
          {%- when 'wave' -%}
            <path d="M0,120 L0,60 Q360,120 720,60 Q1080,0 1440,60 L1440,120 Z" fill="{{ section.settings.top_wave_color }}">
              {%- if section.settings.top_wave_animate -%}
                <animate attributeName="d" dur="{{ section.settings.wave_animation_speed }}s" repeatCount="indefinite" calcMode="spline" keySplines="0.4 0 0.6 1; 0.4 0 0.6 1; 0.4 0 0.6 1; 0.4 0 0.6 1" values="M0,120 L0,60 Q360,120 720,60 Q1080,0 1440,60 L1440,120 Z;M0,120 L0,80 Q360,20 720,80 Q1080,120 1440,40 L1440,120 Z;M0,120 L0,40 Q360,100 720,40 Q1080,0 1440,80 L1440,120 Z;M0,120 L0,70 Q360,10 720,70 Q1080,110 1440,50 L1440,120 Z;M0,120 L0,60 Q360,120 720,60 Q1080,0 1440,60 L1440,120 Z"/>
              {%- endif -%}
            </path>
          {%- when 'double-ripple' -%}
            <path d="M0,120 L0,50 Q360,100 720,50 Q1080,0 1440,50 L1440,120 Z" fill="{{ section.settings.top_wave_color }}">
              {%- if section.settings.top_wave_animate -%}
                <animate attributeName="d" dur="{{ section.settings.wave_animation_speed }}s" repeatCount="indefinite" calcMode="spline" keySplines="0.4 0 0.6 1; 0.4 0 0.6 1; 0.4 0 0.6 1; 0.4 0 0.6 1" values="M0,120 L0,50 Q360,100 720,50 Q1080,0 1440,50 L1440,120 Z;M0,120 L0,70 Q360,20 720,70 Q1080,100 1440,35 L1440,120 Z;M0,120 L0,40 Q360,90 720,40 Q1080,10 1440,70 L1440,120 Z;M0,120 L0,60 Q360,30 720,60 Q1080,90 1440,45 L1440,120 Z;M0,120 L0,50 Q360,100 720,50 Q1080,0 1440,50 L1440,120 Z"/>
              {%- endif -%}
            </path>
            <path d="M0,120 L0,70 Q540,100 1080,70 Q1260,50 1440,65 L1440,120 Z" fill="{{ section.settings.top_wave_color }}" opacity="0.6">
              {%- if section.settings.top_wave_animate -%}
                <animate attributeName="d" dur="{{ section.settings.wave_animation_speed | times: 1.2 }}s" repeatCount="indefinite" calcMode="spline" keySplines="0.4 0 0.6 1; 0.4 0 0.6 1; 0.4 0 0.6 1; 0.4 0 0.6 1" values="M0,120 L0,70 Q540,100 1080,70 Q1260,50 1440,65 L1440,120 Z;M0,120 L0,80 Q540,60 1080,80 Q1260,90 1440,55 L1440,120 Z;M0,120 L0,60 Q540,90 1080,60 Q1260,40 1440,75 L1440,120 Z;M0,120 L0,75 Q540,50 1080,75 Q1260,85 1440,60 L1440,120 Z;M0,120 L0,70 Q540,100 1080,70 Q1260,50 1440,65 L1440,120 Z"/>
              {%- endif -%}
            </path>
          {%- else -%}
            <path d="M0,120 L0,60 Q360,120 720,60 Q1080,0 1440,60 L1440,120 Z" fill="{{ section.settings.top_wave_color }}">
              {%- if section.settings.top_wave_animate -%}
                <animate attributeName="d" dur="{{ section.settings.wave_animation_speed }}s" repeatCount="indefinite" calcMode="spline" keySplines="0.4 0 0.6 1; 0.4 0 0.6 1; 0.4 0 0.6 1; 0.4 0 0.6 1" values="M0,120 L0,60 Q360,120 720,60 Q1080,0 1440,60 L1440,120 Z;M0,120 L0,80 Q360,20 720,80 Q1080,120 1440,40 L1440,120 Z;M0,120 L0,40 Q360,100 720,40 Q1080,0 1440,80 L1440,120 Z;M0,120 L0,70 Q360,10 720,70 Q1080,110 1440,50 L1440,120 Z;M0,120 L0,60 Q360,120 720,60 Q1080,0 1440,60 L1440,120 Z"/>
              {%- endif -%}
            </path>
        {%- endcase -%}
      </svg>
    </div>
  {%- endif -%}

  <!-- Old wave removed -->
  <div class="cstm-container" style="position: relative; z-index: 10; padding-top: {{ section.settings.padding_top }}px; padding-bottom: {{ section.settings.padding_bottom }}px;">
  <div class="common-heading-wrap text-center">
    <h2 class="text-white">{{ section.settings.heading | default: 'Questions? We got you' }}</h2>
  </div>
  <div class="faq-box-wrapper">
    {% for block in section.blocks %}
      <div class="faq-single-box" {{ block.shopify_attributes }}>
        <button class="faq-box" aria-expanded="false" aria-controls="faq-{{ block.id }}">
          {{ block.settings.question }}
          <span class="faq-icon">
            <svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">
              <rect x="0.4" y="0.4" width="27.2" height="27.2" rx="13.6" fill="#FF9F31"/>
              <rect x="0.4" y="0.4" width="27.2" height="27.2" rx="13.6" stroke="#FF9F31" stroke-width="0.8"/>
              <path d="M10.4053 13.4465H13.4386V10.2919H14.5458V13.4465H17.5943V14.5234H14.5458V17.7084H13.4386V14.5234H10.4053V13.4465Z" fill="#1A1A1A"/>
            </svg>
          </span>
        </button>
        <div class="faq-answer" id="faq-{{ block.id }}">
          <p>{{ block.settings.answer }}</p>
        </div>
      </div>
    {% endfor %}
  </div>
  </div>

  <!-- Bottom Wave Divider -->
  {%- if section.settings.show_bottom_wave -%}
    <div class="faq-section__wave faq-section__wave--bottom{% if section.settings.invert_bottom_wave %} inverted{% endif %}" style="height: {{ section.settings.wave_height }}px;">
      <svg viewBox="0 0 1440 120" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg">
        {%- case section.settings.bottom_wave_style -%}
          {%- when 'wave' -%}
            <path d="M0,0 L0,60 Q360,0 720,60 Q1080,120 1440,60 L1440,0 Z" fill="{{ section.settings.bottom_wave_color }}">
              {%- if section.settings.bottom_wave_animate -%}
                <animate attributeName="d" dur="{{ section.settings.wave_animation_speed }}s" repeatCount="indefinite" calcMode="spline" keySplines="0.4 0 0.6 1; 0.4 0 0.6 1; 0.4 0 0.6 1; 0.4 0 0.6 1" values="M0,0 L0,60 Q360,0 720,60 Q1080,120 1440,60 L1440,0 Z;M0,0 L0,40 Q360,100 720,40 Q1080,0 1440,80 L1440,0 Z;M0,0 L0,80 Q360,20 720,80 Q1080,120 1440,40 L1440,0 Z;M0,0 L0,50 Q360,110 720,50 Q1080,10 1440,70 L1440,0 Z;M0,0 L0,60 Q360,0 720,60 Q1080,120 1440,60 L1440,0 Z"/>
              {%- endif -%}
            </path>
          {%- when 'double-ripple' -%}
            <path d="M0,0 L0,70 Q360,20 720,70 Q1080,120 1440,70 L1440,0 Z" fill="{{ section.settings.bottom_wave_color }}">
              {%- if section.settings.bottom_wave_animate -%}
                <animate attributeName="d" dur="{{ section.settings.wave_animation_speed }}s" repeatCount="indefinite" calcMode="spline" keySplines="0.4 0 0.6 1; 0.4 0 0.6 1; 0.4 0 0.6 1; 0.4 0 0.6 1" values="M0,0 L0,70 Q360,20 720,70 Q1080,120 1440,70 L1440,0 Z;M0,0 L0,50 Q360,100 720,50 Q1080,20 1440,85 L1440,0 Z;M0,0 L0,80 Q360,30 720,80 Q1080,110 1440,50 L1440,0 Z;M0,0 L0,60 Q360,90 720,60 Q1080,30 1440,75 L1440,0 Z;M0,0 L0,70 Q360,20 720,70 Q1080,120 1440,70 L1440,0 Z"/>
              {%- endif -%}
            </path>
            <path d="M0,0 L0,50 Q540,20 1080,50 Q1260,70 1440,55 L1440,0 Z" fill="{{ section.settings.bottom_wave_color }}" opacity="0.6">
              {%- if section.settings.bottom_wave_animate -%}
                <animate attributeName="d" dur="{{ section.settings.wave_animation_speed | times: 1.2 }}s" repeatCount="indefinite" calcMode="spline" keySplines="0.4 0 0.6 1; 0.4 0 0.6 1; 0.4 0 0.6 1; 0.4 0 0.6 1" values="M0,0 L0,50 Q540,20 1080,50 Q1260,70 1440,55 L1440,0 Z;M0,0 L0,40 Q540,60 1080,40 Q1260,30 1440,65 L1440,0 Z;M0,0 L0,60 Q540,30 1080,60 Q1260,80 1440,45 L1440,0 Z;M0,0 L0,45 Q540,70 1080,45 Q1260,35 1440,60 L1440,0 Z;M0,0 L0,50 Q540,20 1080,50 Q1260,70 1440,55 L1440,0 Z"/>
              {%- endif -%}
            </path>
          {%- else -%}
            <path d="M0,0 L0,60 Q360,0 720,60 Q1080,120 1440,60 L1440,0 Z" fill="{{ section.settings.bottom_wave_color }}">
              {%- if section.settings.bottom_wave_animate -%}
                <animate attributeName="d" dur="{{ section.settings.wave_animation_speed }}s" repeatCount="indefinite" calcMode="spline" keySplines="0.4 0 0.6 1; 0.4 0 0.6 1; 0.4 0 0.6 1; 0.4 0 0.6 1" values="M0,0 L0,60 Q360,0 720,60 Q1080,120 1440,60 L1440,0 Z;M0,0 L0,40 Q360,100 720,40 Q1080,0 1440,80 L1440,0 Z;M0,0 L0,80 Q360,20 720,80 Q1080,120 1440,40 L1440,0 Z;M0,0 L0,50 Q360,110 720,50 Q1080,10 1440,70 L1440,0 Z;M0,0 L0,60 Q360,0 720,60 Q1080,120 1440,60 L1440,0 Z"/>
              {%- endif -%}
            </path>
        {%- endcase -%}
      </svg>
    </div>
  {%- endif -%}
</section>

<!-- FAQ Schema Markup -->
<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "FAQPage",
    "mainEntity": [
      {% for block in section.blocks %}
      {
        "@type": "Question",
        "name": {{ block.settings.question | json }},
        "acceptedAnswer": {
          "@type": "Answer",
          "text": {{ block.settings.answer | json }}
        }
      }{% unless forloop.last %},{% endunless %}
      {% endfor %}
    ]
  }
</script>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const faqBoxes = document.querySelectorAll('.faq-box');

    faqBoxes.forEach(function (faqBox) {
      faqBox.addEventListener('click', function () {
        const parent = this.parentElement;
        const isActive = parent.classList.contains('active');

        // Close all other FAQs
        document.querySelectorAll('.faq-single-box').forEach(function (box) {
          box.classList.remove('active');
          const btn = box.querySelector('.faq-box');
          if (btn) btn.setAttribute('aria-expanded', 'false');
        });

        // Toggle current FAQ
        if (!isActive) {
          parent.classList.add('active');
          this.setAttribute('aria-expanded', 'true');
        }
      });
    });
  });
</script>

{% schema %}
{
  "name": "FAQ Section",
  "tag": "section",
  "class": "faq-sec",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Section Heading",
      "default": "Questions? We got you"
    },
    {
      "type": "header",
      "content": "Spacing"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 150,
      "step": 5,
      "unit": "px",
      "label": "Top Padding",
      "default": 80
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 150,
      "step": 5,
      "unit": "px",
      "label": "Bottom Padding",
      "default": 80
    },
    {
      "type": "header",
      "content": "Wave Dividers"
    },
    {
      "type": "range",
      "id": "wave_height",
      "label": "Wave Height",
      "min": 30,
      "max": 150,
      "step": 10,
      "default": 80,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "wave_animation_speed",
      "label": "Animation Speed",
      "min": 3,
      "max": 15,
      "step": 1,
      "default": 8,
      "unit": "s",
      "info": "Duration of one wave cycle"
    },
    {
      "type": "header",
      "content": "Top Wave"
    },
    {
      "type": "checkbox",
      "id": "show_top_wave",
      "label": "Show Top Wave",
      "default": false
    },
    {
      "type": "select",
      "id": "top_wave_style",
      "label": "Top Wave Style",
      "options": [
        { "value": "wave", "label": "Wave One" },
        { "value": "double-ripple", "label": "Double Ripple" }
      ],
      "default": "wave"
    },
    {
      "type": "color",
      "id": "top_wave_color",
      "label": "Top Wave Color",
      "default": "#FFE6CB",
      "info": "Should match the section above"
    },
    {
      "type": "checkbox",
      "id": "top_wave_animate",
      "label": "Animate Top Wave",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "invert_top_wave",
      "label": "Invert Top Wave",
      "default": false,
      "info": "Flip the wave vertically"
    },
    {
      "type": "header",
      "content": "Bottom Wave"
    },
    {
      "type": "checkbox",
      "id": "show_bottom_wave",
      "label": "Show Bottom Wave",
      "default": false
    },
    {
      "type": "select",
      "id": "bottom_wave_style",
      "label": "Bottom Wave Style",
      "options": [
        { "value": "wave", "label": "Wave One" },
        { "value": "double-ripple", "label": "Double Ripple" }
      ],
      "default": "wave"
    },
    {
      "type": "color",
      "id": "bottom_wave_color",
      "label": "Bottom Wave Color",
      "default": "#FFE6CB",
      "info": "Should match the section below"
    },
    {
      "type": "checkbox",
      "id": "bottom_wave_animate",
      "label": "Animate Bottom Wave",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "invert_bottom_wave",
      "label": "Invert Bottom Wave",
      "default": false,
      "info": "Flip the wave vertically"
    }
  ],
  "blocks": [
    {
      "type": "faq_item",
      "name": "FAQ Item",
      "settings": [
        {
          "type": "text",
          "id": "question",
          "label": "Question",
          "default": "Are these THC shelters legal in my state?"
        },
        {
          "type": "textarea",
          "id": "answer",
          "label": "Answer",
          "default": "Lorem ipsum dolor sit amet consectetur adipisicing elit."
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "FAQ Section"
    }
  ]
}
{% endschema %}
